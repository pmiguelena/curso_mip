---
title: "Clase 4"
format: html
---

# Introducción

En esta clase trabajaremos con un **Modelo Insumo-Producto (MIP)** de Argentina.\
El objetivo es que el estudiante comprenda cómo se construye la matriz de coeficientes, la inversa de Leontief y cómo, a partir de shocks de demanda, se estiman efectos sobre producción, empleo, valor agregado y recaudación.

------------------------------------------------------------------------

# Carga de paquetes

```{r}
library(ggplot2)
library(dplyr)
library(tidyverse)
```

------------------------------------------------------------------------

# Carga de datos

Leemos las descripciones de actividades y la **matriz insumo-producto** (industria × industria).

```{r}
n <- 10
sectores <- paste0("Sector_", 1:n)

# Matriz de transacciones intermedias (Z)
Z <- matrix(sample(50:200, n*n, replace=TRUE), nrow=n, ncol=n,
            dimnames = list(sectores, sectores))

# Vector de producción bruta (VBP): suma de filas de Z + demanda final
Y <- matrix(sample(100:500, n, replace=TRUE), nrow=n, dimnames = list(sectores, "Demanda Final"))
VBP <- rowSums(Z) + Y

# Valor agregado simulado
VA <- round(VBP * runif(n, 0.3, 0.6))

# Recaudación simulada (impuestos)
reca <- round(VBP * runif(n, 0.1, 0.2))

# Recaudación simulada (impuestos)
impo <- round(VBP * runif(n, 0.1, 0.2))

# Recaudación simulada (impuestos)
expo <- round(VBP * runif(n, 0.1, 0.2))

# Empleo simulado
labor <- round(VBP * runif(n, 0.05, 0.15))
```

------------------------------------------------------------------------

# Construcción de la inversa de Leontief

El corazón del modelo es la **matriz de coeficientes técnicos** $A$ y su inversa:

\[ B = (I - A)\^{-1} \]

```{r}
iden <- diag(n)
tot <- VBP
diag_tot <- diag(c(1/tot))

A <- Z %*% diag_tot  
A[is.nan(A)] <- 0

B <- solve(iden - A)
```

------------------------------------------------------------------------

# Simulaciones de demanda

Leemos shocks de demanda final (ΔY) y construimos el vector de cambios ajustado por contenido nacional.

```{r}
f.chg.nac <- Y * 0.10

# Resolvemos: ΔX = B * ΔY
x.chg <- B %*% as.matrix(f.chg.nac)
```

------------------------------------------------------------------------

# Impactos en empleo, recaudación y VA

### Empleo

Calculamos un coeficiente trabajo/producto y estimamos los cambios en empleo.

```{r}
LsobreVBP <- labor / VBP
lab.chg <- LsobreVBP * x.chg
```

### Recaudación

A partir de los impuestos por unidad de producto.

```{r}
TAXsobreVBP <- reca / VBP
tax.chg <- TAXsobreVBP * x.chg
```

### Valor agregado

Calculamos proporcional al producto sectorial.

```{r}
VAsobreVBP <- VA / VBP
va.chg <- VAsobreVBP * x.chg
```

------------------------------------------------------------------------

# Resultados agregados

Creamos una tabla con los efectos totales sobre **producción, VA y recaudación**.

```{r}
gral_res <- data.frame(
  Variable = c("Producción", "Valor Agregado", "Recaudación"),
  Base = c(sum(VBP), sum(VA), sum(reca)),
  Cambio = c(sum(x.chg), sum(va.chg), sum(tax.chg))
) %>%
  mutate(Cambio_pct = 100 * Cambio/Base)

gral_res

```

Visualización:

```{r}
ggplot(gral_res, aes(x=Variable, y=Cambio)) +
  geom_col(fill="steelblue") +
  theme_minimal() +
  labs(y="Cambio absoluto", title="Impacto agregado (simulado)")
```

------------------------------------------------------------------------

# Conclusión

En esta clase vimos cómo a partir de una matriz insumo-producto se pueden:

-   Construir coeficientes técnicos y la inversa de Leontief.\
-   Simular shocks de demanda final.\
-   Estimar impactos en producción, valor agregado, recaudación y empleo.

Este marco es muy útil para el análisis de política económica y la planificación sectorial.
